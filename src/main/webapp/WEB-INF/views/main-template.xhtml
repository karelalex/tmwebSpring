<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:sec="http://www.springframework.org/security/tags">


<ui:composition>
    <h:head>
    </h:head>
    <h:body>
        <ui:param name="userName" value="#{mainController.userName}"/>
        <p:menubar id="mainBar">
            <p:menuitem value="Главная" outcome="main" icon="fa fa-home"/>

            <sec:authorize url="/project/*">
                <p:submenu icon="fa fa-navicon" label="Проекты" rendered="#{sec:isAllowed('/project/*', 'GET')}">
                    <p:menuitem icon="fa fa-plus" value="Создать" outcome="project">
                        <f:param value="true" name="create"/>
                    </p:menuitem>
                    <p:menuitem value="Список" outcome="projectList" icon="fa fa-list"/>
                </p:submenu>
            </sec:authorize>

            <p:submenu icon="fa fa-tasks" label="Задачи" rendered="#{sec:isAllowed('/task/*', 'GET')}">
                <p:menuitem icon="fa fa-plus" value="Создать" outcome="task">
                    <f:param value="true" name="create"/>
                </p:menuitem>
                <p:menuitem value="Список" outcome="taskList" icon="fa fa-list"/>
            </p:submenu>

            <sec:authorize access="!isAuthenticated()">
                <p:menuitem value="Регистрация" outcome="registration" icon="fa fa-hand-o-up"/>
            </sec:authorize>

            <f:facet name="options">
                <sec:authorize access="!isAuthenticated()">
                    <form id="loginForm" action="#{request.contextPath}/singIn" method="post"
                          enctype="application/x-www-form-urlencoded">
                        <p:outputLabel for="username" value="Логин"/><p:spacer width="5"/>
                        <p:inputText id="username" placeholder="Логин">
                        </p:inputText>
                        <p:spacer width="10"/>
                        <p:outputLabel for="password" value="Пароль"/><p:spacer width="5"/>
                        <p:password id="password" placeholder="Пароль">
                        </p:password>
                        <button type="submit">Войти</button>
                    </form>
                </sec:authorize>

                <sec:authorize access="isAuthenticated()">
                    <h:outputText value="Привет #{mainController.userName}"/> <p:spacer width="10"/>
                    <p:button value="Выйти" href="#{request.contextPath}/singOut" ajax="false"/>
                </sec:authorize>

            </f:facet>
        </p:menubar>
        <p:panel id="basic" header="#{pageName}" footer="&copy; Все права принадлежат создателям сайта"
                 style="margin-bottom:20px">
            <ui:insert name="mainBody">
            </ui:insert>
        </p:panel>
        <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
            <p:commandButton value="Да" type="button" styleClass="ui-confirmdialog-yes" icon="fa fa-check-circle"/>
            <p:commandButton value="Нет" type="button" styleClass="ui-confirmdialog-no" icon="fa fa-times-circle"/>
        </p:confirmDialog>
    </h:body>
</ui:composition>
>
</html>
